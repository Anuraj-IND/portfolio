!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ClipboardHandler=e()}}(function(){var define,module,exports;return function a(o,s,l){function u(t,e){if(!s[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(p)return p(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[t]={exports:{}};o[t][0].call(i.exports,function(e){return u(o[t][1][e]||e)},i,i.exports,a,o,s,l)}return s[t].exports}for(var p="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,t,r){var f,n,ne,i,p,a,O,o,k,s,T,l,u=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(o=(a<3?i(o):3<a?i(t,r,o):i(t,r))||o);return 3<a&&o&&Object.defineProperty(t,r,o),o},ie=(c.Instance=function(){return c._self},c.prototype.Info=function(e){console.log(e)},c.prototype.Warn=function(e){console.log("WARN: "+e)},c.prototype.Fatal=function(e){console.log("FATAL: "+e)},c.prototype.Debug=function(e){this.IsDebuggingEnabled()&&console.log("Debug: "+e)},c.prototype.IsDebuggingEnabled=function(){var e=!1,t=We.GetCookie("Debug");return t&&(e="true"==t.toLocaleLowerCase()),e},c._self=new c,c);function c(){}(n=f=f||{})[n.Undefined=0]="Undefined",n[n.CreateSeparateSlides=1]="CreateSeparateSlides",n[n.ParseAsNestedList=2]="ParseAsNestedList",(i=ne=ne||{})[i.None=0]="None",i[i.Text=1]="Text",i[i.Image=2]="Image",i[i.Separator=3]="Separator",i[i.Boundary=4]="Boundary",i[i.Root=99]="Root",(a=p=p||{})[a[void 0]=0]="undefined",a[a.h1=1]="h1",a[a.h2=2]="h2",a[a.h3=3]="h3",a[a.h4=4]="h4",a[a.h5=5]="h5",a[a.h6=6]="h6",a[a.p=7]="p",a[a.em=8]="em",a[a.a=9]="a",a[a.figure=10]="figure",a[a.img=11]="img",a[a.ul=12]="ul",a[a.ol=13]="ol",a[a.li=14]="li",a[a.div=15]="div",a[a.customtext=16]="customtext",(o=O=O||{})[o.Undefined=0]="Undefined",o[o.Text=1]="Text",o[o.Image=2]="Image",o[o.Url=3]="Url",(s=k=k||{})[s.Undefined=0]="Undefined",s[s.Background=1]="Background",s[s.Chart=2]="Chart",s[s.Diagram=3]="Diagram",s[s.Image=4]="Image",s[s.List=5]="List",s[s.Table=6]="Table",s[s.Links=7]="Links",s[s.TitleSubtitle=8]="TitleSubtitle",(l=T=T||{})[l.Undefined=0]="Undefined",l[l.Diagram=1]="Diagram",l[l.TitleSubtitle=2]="TitleSubtitle",l[l.TitleSubtitleList=3]="TitleSubtitleList",l[l.TitleSubtitleTable=4]="TitleSubtitleTable",l[l.TitleOnly=5]="TitleOnly",l[l.TitleWithList=6]="TitleWithList",l[l.TitleAndTable=7]="TitleAndTable",l[l.TitleAndImages=8]="TitleAndImages",l[l.TitleTextLinks=9]="TitleTextLinks",l[l.ImageOnly=10]="ImageOnly",l[l.ImageTitle=11]="ImageTitle",l[l.TitleSubtitleImage=12]="TitleSubtitleImage",l[l.Quote=13]="Quote",l[l.List=14]="List",l[l.TitleWithDualList=15]="TitleWithDualList",l[l.Table=16]="Table",l[l.Chart=17]="Chart",l[l.ImageList=18]="ImageList";var v=(h.IsLineBreak=function(e){return!(!e||new RegExp(/\S/gm).test(e)||!new RegExp(/\n|\r/gm).test(e))},h.IsString=function(e){return"string"==typeof e||e instanceof String},h.FixHtmlString=function(e){var t="";return e&&(t=h.TrimString(e)),t},h.IsStringNullOrWhitespace=function(e){var t=!0;return e&&h.IsString(e)&&0<e.trim().length&&(t=!1),t},h.CompareNoCase=function(e,t){var r=!1;return h.IsString(e)&&h.IsString(t)&&e.toLowerCase()==t.toLowerCase()&&(r=!0),r},h.StringFromEnum=function(e,t){var r="";return"PitchDeckSlideType"==e?r=T[t]:"MatrixType"==e?r=k[t]:"ObjectType"==e?r=O[t]:ie.Instance().Fatal('FATAL: Cannot convert enum "'+t+'" to string!!'),h.IsString(r)&&(r=r.toLowerCase()),r},h.GetMemberCount=function(e){return Object.keys(e).length},h.CombineArray=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];t.push(n)}},h.IsNullOrEmpty=function(e){var t=!0;return e&&(void 0!==e&&null!=e||(t=!0),t=e.replace(/\s/gm,"").length<1),t},h.TrimString=function(e){return h.IsNullOrEmpty(e)?"":e.trim()},h.Split=function(e){var t=[],r=[];if(!h.IsNullOrEmpty(e)&&(t=e.split(/[\r\n]+/gm))&&0<t.length)for(var n=0;n<t.length;n++){var i=h.TrimString(t[n]);h.IsStringNullOrWhitespace(i)||r.push(i)}return r},h.RemoveFromArray=function(e,t){if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}return!1},h.IsNumber=function(e){if(e){var t=Number(e);if(!Number.isNaN(t))return!0}return!1},h.hasOwnProperty=Object.prototype.hasOwnProperty,h.CleanupJSONObject=function(e){for(var t in e)if(h.hasOwnProperty.call(e,t)){var r=e[t];if(null==r)delete e[t];else if(Array.isArray(r))if(0==r.length)delete e[t];else for(var n=0;n<r.length;n++)h.CleanupJSONObject(r[n]);else"object"==typeof r?h.CleanupJSONObject(r):"string"==typeof r?null==r&&delete e[t]:void 0===r&&delete e[t]}return e},h);function h(){}var d,b,y,g,m=(Object.defineProperty(I.prototype,"Url",{get:function(){return this._url},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"Width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"Height",{get:function(){return this._height},enumerable:!1,configurable:!0}),I);function I(e,t,r){this._url=e,this._width=t,this._height=r}(b=d=d||{})[b.HtmlElement=1]="HtmlElement",b[b.TextNode=3]="TextNode",(g=y=y||{})[g.Undefined=0]="Undefined",g[g.Normal=1]="Normal",g[g.NowWrap=2]="NowWrap",g[g.Pre=3]="Pre",g[g.PreWrap=4]="PreWrap",g[g.PreLine=5]="PreLine",g[g.BreakSpaces=6]="BreakSpaces";var ae=(S.GetElementRenderingType=function(e){var t=se.Unspecified;if(e&&(S.IsBlockElement(e)?t=se.Block:S.IsInlineElement(e)?t=se.Inline:S.IsElementDisplayNone(e)&&(t=se.DontDisplay)),t==se.Unspecified){var r=oe.GetElementTagName(e);ie.Instance().Info(r+" - could not find render type")}return t},S.InternalRenderCompare=function(e,t,r){var n=!1;if(e){var i=S.GetStyleDisplayRendering(e);if(i==se.Unspecified){var a=oe.GetElementTagName(e);n=-1!==t.indexOf(a)}else n=i==r}return n},S.IsBlockElement=function(e){return S.InternalRenderCompare(e,S.BlockElements,se.Block)},S.IsInlineElement=function(e){return S.InternalRenderCompare(e,S.InlineElements,se.Inline)},S.GetStyleDisplayRendering=function(e){var t=se.Unspecified;if(e){var r=oe.GetStyle(e,"display");r&&(t=S.GetElementRenderingTypeFromString(r))}return t},S.GetElementRenderingTypeFromString=function(e){var t=se.Unspecified;if(!v.IsStringNullOrWhitespace(e))switch(e){case"initial":t=se.Unspecified;break;case"none":t=se.DontDisplay;break;case"block":case"flex":case"inline-block":case"list-item":case"table":case"table-caption":case"table-cell":case"table-column":case"table-column-group":case"table-footer-group":case"table-header-group":case"table-row":case"table-row-group":t=se.Block;break;case"inline":case"inline-flex":case"inline-table":case"marker":t=se.Inline}return t},S.IsElementDisplayNone=function(e){return S.GetStyleDisplayRendering(e)===se.DontDisplay},S.BlockElements=["address","article","aside","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","li","main","nav","noscript","ol","p","pre","section","table","tbody","tfoot","ul","video","td","tr","th"],S.InlineElements=["a","abbr","acronym","b","bdo","big","br","button","cite","code","dfn","em","i","img","input","kbd","label","map","object","output","q","samp","script","select","small","span","strong","sub","sup","textarea","time","tt","var","font","u","#text"],S);function S(){}var L,w,oe=(j.GetFontWeight=function(e){var t=0,r=$(e).css("font-weight");if(!v.IsStringNullOrWhitespace(r))if(v.IsNumber(r))t=Number(r);else switch(r.toLowerCase()){case"normal":t=400;break;case"bold":t=700;break;case"bolder":t=800;break;case"lighter":t=300}return t},j.IsBoundary=function(e){var t=!1;if(e){var r=e.innerText;t=v.IsLineBreak(r)}return t},j.GetAllChildren=function(e){return $(e).contents()},j.HasContent=function(e){var t=!1,r=j.GetElementText(e,!1);return v.IsStringNullOrWhitespace(r)||(t=!0),t=t||!!j.GetImageChild(e)},j.GetElementText=function(e,t){var r="";if(t)r=$(e).text(),r=v.FixHtmlString(r);else if(e.nodeType==d.HtmlElement){var n=$(e).contents().filter(function(e){return e.nodeType==d.TextNode})[0];n&&(r=n.nodeValue)}else e.nodeType==d.TextNode&&(r=v.TrimString(e.nodeValue));return r},j.GetImageChild=function(e){if(e){var t=$(e)[0];if(t){var r=j.GetAttribute(t,"src"),n=j.GetAttribute(t,"width"),i=j.GetAttribute(t,"height"),a=0;n&&v.IsNumber(n)&&(a=Number(n));var o=0;return v.IsNumber(i)&&(o=Number(i)),new m(r,a,o)}}return null},j.CreateHtmlNodeText=function(e){if(e){for(var t=null,r=0,n=j.GetAllChildren(e);r<n.length;r++){var i=n[r];if(3==i.nodeType&&(t=i.nodeValue))break}if(t){var a=new ue;a.SetValue(ne.Text,t);var o=j.IsElementHeader(e),s=j.GetHeaderSize(e),l=ae.GetElementRenderingType(e);return a.SetRenderingBehavior(l),a.SetAsHeader(o),a.HeaderSize=s,a}}return null},j.IdentifyHtmlNode=function(e){var t=null,r=j.GetElementTagName(e);if("#text"==r){var n=j.GetElementText(e,!1);n&&((t=new ue).SetRenderingBehavior(se.Inline),t.SetValue(ne.Text,n))}else if("img"==r){var i=j.GetImageChild(e);if(i&&i.Url){(t=new ue).SetValue(ne.Image,i.Url);var a=ae.GetElementRenderingType(e);t.SetRenderingBehavior(a)}}else"br"==r?((t=new ue).SetAsSeparator(),t.SetAsLineBreak(),t.SetRenderingBehavior(se.Inline)):"wbr"==r&&((t=new ue).SetValue(ne.Text,""),t.SetRenderingBehavior(se.Inline),t.SetAsLineBreak());return t},j.GetElementTagName=function(e){var t=null;if(e)if(e.nodeType==d.TextNode)t="#text";else if(e.nodeType==d.HtmlElement){var r=$(e),n=$(r).prop("tagName");v.IsStringNullOrWhitespace(n)?ie.Instance().Fatal("Cannot retrieve tagName property - serious. => "+e):t=n.toLowerCase()}return t},j.GetHtmlTagEnumName=function(e){return p[e]},j.GetHeaderSize=function(e){var t=j.GetElementTagName(e),r=L.Undefined;switch(t){case"h1":r=L.H1;break;case"h2":r=L.H2;break;case"h3":r=L.H3;break;case"h4":r=L.H4;break;case"h5":r=L.H5;break;case"h6":r=L.H6;break;case"strong":case"b":r=L.Strong}return r},j.IsElementHeader=function(e){var t=j.GetElementTagName(e);return"h1"==t||"h2"==t||"h3"==t||"h4"==t||"h5"==t||"h6"==t||"strong"==t||"b"==t},j.IsElementTable=function(e){return"table"==j.GetElementTagName(e)},j.IsElementList=function(e){var t=j.GetElementTagName(e);return"ol"==t||"ul"==t},j.IsTagIgnorable=function(e){var t=!0;if(e&&(e.nodeType==d.HtmlElement||e.nodeType==d.TextNode)){var r=j.GetElementTagName(e);t="title"==r||"script"==r||"style"==r||"meta"==r||r.startsWith("o:")}return t},j.GetEntryPoint=function(e){for(var t=!1,r=e;!t;)if(r){if(j.IsElementTable(r)||j.IsElementList(r)){t=!0;break}var n=$(r).children();r&&n&&0<n.length&&1==n.length?(r=n[0],j.HasContent(r)&&(t=!0)):t=!0}return t?r:e},j.GetStyle=function(e,t){var r="";return e&&e.style&&(r=e.style[t]),r},j.GetAttribute=function(e,t){var r="";return e&&(r=e.getAttribute(t)),r},j.IsElementTableHeader=function(e){return"th"==j.GetElementTagName(e)},j.IsElementTableCell=function(e){return"td"==j.GetElementTagName(e)},j.IsElementTableRow=function(e){return"tr"==j.GetElementTagName(e)},j.IsLastNode=function(e){var t=!1;return e&&e.children&&0==e.children.length&&(t=!0),t},j.IsTextPlaceholder=function(e){var t=!1;return"#text"==j.GetElementTagName(e)&&(t=!0),t},j.GetInnerHtml=function(e){var t="";return e&&(t=$(e).innerHTML),t},j.IsElementBreak=function(e){var t=!1;if("#text"==j.GetElementTagName(e))t=!0;else{var r=j.GetSupportedChildren(e);if(r&&0<r.length){for(var n=!0,i=0;i<r.length;i++){var a=r[i];if("br"!=j.GetElementTagName(a)){n=!1;break}}t=n}}return t},j.GetSupportedChildren=function(e){var t=[];return e&&(t=$(e).contents().filter(function(e){return e.nodeType==d.HtmlElement||e.nodeType==d.TextNode})),t},j.HasStyle=function(e,t,r){var n=!1;if(e&&t){var i=j.GetStyle(e,t);if(!v.IsNullOrEmpty(i))if(i=i.toLowerCase(),r)for(var a=0;a<r.length;a++){var o=r[a];if(o&&o.toLocaleLowerCase()==i){n=!0;break}}else n=!0}return n},j.HasAttribute=function(e,t){var r=!1;return e&&(r=e.hasAttribute(t)),r},j.HasOnlyTextNodes=function(e){var t=!1;if(e){var r=j.GetAllChildren(e);if(r&&0<r.length){for(var n=!0,i=0,a=r;i<a.length;i++)if(3!=a[i].nodeType){n=!1;break}t=n}}return t},j.IsPreFormattedElement=function(e){return"pre"==j.GetElementTagName(e)},j);function j(){}(w=L=L||{})[w.Undefined=0]="Undefined",w[w.H1=800]="H1",w[w.H2=700]="H2",w[w.H3=600]="H3",w[w.H4=500]="H4",w[w.H5=400]="H5",w[w.H6=300]="H6",w[w.Strong=200]="Strong";var P=(Object.defineProperty(N.prototype,"Marker",{get:function(){return this.marker},set:function(e){this.marker=e},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"Text",{get:function(){return this.text},set:function(e){this.text=e},enumerable:!1,configurable:!0}),N);function N(){this.marker=null,this.text=null}var x=(Object.defineProperty(H.prototype,"HeaderSize",{get:function(){return this.headerSize},set:function(e){this.headerSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"Level",{get:function(){return this.level},set:function(e){this.level=e},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"IsPartOfGroupedObject",{get:function(){return this.isPartOfTable||this.isPartOfList},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"IsListActual",{get:function(){return this.isListActual},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"IsPartOfTable",{get:function(){return this.isPartOfTable},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"IsPartOfList",{get:function(){return this.isPartOfList},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"IsTableCellBlank",{get:function(){return this.isTableCellBlank},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"IsHeader",{get:function(){return this.isHeader},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"IsBold",{get:function(){return this.isBold},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"Tag",{get:function(){return this.tag},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"Value",{get:function(){return this.value},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"BulletMarker",{get:function(){return this.bulletMarker},enumerable:!1,configurable:!0}),H.prototype.FlagAsHeader=function(e){this.isHeader=e},H.prototype.Dump=function(){return"("+oe.GetHtmlTagEnumName(this.tag)+") => "+this.value},H.FromHtmlNode=function(e){var t=null;if(e&&(e.NodeType==ne.Image?t=new H(p.img,e.Value):e.NodeType==ne.Text&&(t=new H(p.p,e.Value)),t)){if(e.ListMetadata){var r=new P;r.Marker=e.ListMetadata.ListNumber,r.Text=t.Value,t.SetBullet(r)}t.FlagAsHeader(e.IsHeader),t.SetBold(e.IsBold),t.SetListActual(e.IsListActual),t.SetAsPartOfTable(e.IsPartOfTable),t.SetAsPartOfList(e.IsPartOfList),t.SetTableCellBlank(e.IsBlankTableCell),t.HeaderSize=e.HeaderSize,t.Level=e.Level}return t},H.prototype.Clone=function(){var e=new H(this.Tag,this.Value);return e.FlagAsHeader(this.IsHeader),e},H.prototype.SetBold=function(e){this.isBold=e},H.prototype.SetListActual=function(e){this.isListActual=e},H.prototype.SetAsPartOfTable=function(e){this.isPartOfTable=e},H.prototype.SetAsPartOfList=function(e){this.isPartOfList=e},H.prototype.SetTableCellBlank=function(e){this.isTableCellBlank=e},H.prototype.SetTextValue=function(e){this.tag=p.p,this.value=e},H.prototype.SetBullet=function(e){e&&(this.bulletMarker=e)},H.prototype.IsEmptyOrWhiteSpace=function(){return v.IsStringNullOrWhitespace(this.Value)},H.prototype.ChangeValue=function(e){this.value=e},H);function H(e,t){this.tag=p.undefined,this.value="",this.isHeader=!1,this.isBold=!1,this.isPartOfTable=!1,this.isListActual=!1,this.isTableCellBlank=!1,this.isPartOfList=!1,this.level=-1,this.bulletMarker=null,this.headerSize=L.Undefined,this.tag=e,this.value=t}var se,A,le=(Object.defineProperty(E.prototype,"ListNumber",{get:function(){return this.numbering},enumerable:!1,configurable:!0}),E.prototype.SetNumbering=function(e){this.numbering=e},E);function E(){this.numbering=null}(A=se=se||{})[A.Unspecified=0]="Unspecified",A[A.DontDisplay=1]="DontDisplay",A[A.Block=2]="Block",A[A.Inline=3]="Inline";var ue=(Object.defineProperty(M.prototype,"HeaderSize",{get:function(){return this.headerSize},set:function(e){this.headerSize=e},enumerable:!1,configurable:!0}),M.prototype.SetAsLineBreak=function(){this.isLineBreak=!0},M.prototype.SetAsHeader=function(e){this.isHeader=e},M.prototype.SetLevel=function(e){this.level=e},M.prototype.SetAsListActual=function(){this.isListActual=!0},M.prototype.SetAsPartOfList=function(e,t){this.isPartOfList=e,this.listMetadata=t},M.prototype.SetAsPartOfTable=function(e){this.isPartOfTable=e},M.prototype.SetAsTableCellBlank=function(e){this.isTableCellBlank=e},M.prototype.SetAsRoot=function(){this.nodeType=ne.Root},M.prototype.SetAsSeparator=function(){this.nodeType=ne.Separator},M.prototype.SetBold=function(e){this.isBold=e},M.prototype.SetItalic=function(e){this.isItalic=e},M.prototype.SetAsBoundary=function(){this.nodeType=ne.Boundary,this.SetRenderingBehavior(se.Block)},M.prototype.SetValue=function(e,t){this.nodeType=e,this.value=t},M.prototype.SetRenderingBehavior=function(e){this.renderingBehavior=e},Object.defineProperty(M.prototype,"IsLineBreak",{get:function(){return this.isLineBreak},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"IsHeader",{get:function(){return this.isHeader},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"IsPartOfList",{get:function(){return this.isPartOfList},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"IsListNestedWithinList",{get:function(){return this.isListNestedWithinList},set:function(e){this.isListNestedWithinList=e},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"IsPartOfTable",{get:function(){return this.isPartOfTable},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"IsListActual",{get:function(){return this.isListActual},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"IsBlankTableCell",{get:function(){return this.isTableCellBlank},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"Value",{get:function(){return this.value},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"Level",{get:function(){return this.level},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"IsBold",{get:function(){return this.isBold},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"IsItalic",{get:function(){return this.isItalic},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"IsRoot",{get:function(){return this.nodeType==ne.Root},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"IsBoundary",{get:function(){return this.nodeType==ne.Boundary},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"NodeType",{get:function(){return this.nodeType},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"RenderingBehavior",{get:function(){return se[this.renderingBehavior]},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"RenderingBehaviorType",{get:function(){return this.renderingBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"Children",{get:function(){return this.children},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"ListMetadata",{get:function(){return this.listMetadata},enumerable:!1,configurable:!0}),M.prototype.Copy=function(e){e?(this.nodeType=e.NodeType,this.value=e.Value):ie.Instance().Fatal("Node.Copy: cannot copy null element")},Object.defineProperty(M.prototype,"HasContent",{get:function(){var e=!1;if(this.Children&&0<this.Children.length)for(var t=0,r=this.Children;t<r.length;t++){var n=r[t];if(n&&n.HasContent){e=!0;break}}else e=M.HasValue(this);return e},enumerable:!1,configurable:!0}),M.prototype.IsValid=function(){return this.nodeType!=ne.None},Object.defineProperty(M.prototype,"HasChildren",{get:function(){return this.children&&0<this.children.length},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"HasChildrenWithContent",{get:function(){var e=this.children&&0<this.children.length;if(e){for(var t=!1,r=0;r<this.children.length;r++){var n=this.children[r];if(n&&n.HasContent){t=!0;break}}e=t}return e},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"IsSeparator",{get:function(){return this.nodeType==ne.Separator},enumerable:!1,configurable:!0}),M.Parse=function(e){if(!v.IsStringNullOrWhitespace(e)){var t=e.split(/[\n\r]+/);if(t&&0<t.length){for(var r=[],n=0;n<t.length;n++){var i=v.TrimString(t[n]);if(!v.IsStringNullOrWhitespace(i)){var a=new M;a.SetValue(ne.Text,i),r.push(a)}}if(r&&0<r.length)return r}}return null},M.HasValue=function(e){return e?e.nodeType==ne.Text||e.nodeType==ne.Image:(ie.Instance().Warn("HasValue: Strange: expected the node to be valid and non null"),!1)},M.JoinInlineNodes=function(e,t){var r=null;if(this.AreBothInlineTextNodes(e,t)){var n=e.Value+t.Value;r=new M,(e.IsPartOfTable||t.IsPartOfTable)&&r.SetAsPartOfTable(!0),r.SetValue(ne.Text,n),r.SetRenderingBehavior(se.Inline)}return r||ie.Instance().Fatal("JoinInlineNodes failed."),r},M.AreBothInlineTextNodes=function(e,t){var r=!1;return e&&t&&e.RenderingBehaviorType==se.Inline&&t.RenderingBehaviorType==se.Inline&&e.NodeType==ne.Text&&t.NodeType==ne.Text&&(r=!0),r},M.AreAllNodesSeparators=function(e){var t=!1;if(e){for(var r=0,n=0;n<e.length;n++){var i=e[n];i&&i.IsSeparator&&r++}t=r==e.length}return t},M);function M(){this.nodeType=ne.None,this.headerSize=L.Undefined,this.isHeader=!1,this.isPartOfList=!1,this.isPartOfTable=!1,this.isTableCellBlank=!1,this.listMetadata=null,this.renderingBehavior=se.Unspecified,this.isBold=!1,this.isItalic=!1,this.isLineBreak=!1,this.isListActual=!1,this.isListNestedWithinList=!1,this.level=-1,this.nodeType=ne.None,this.value="",this.children=[]}var pe=(Object.defineProperty(C.prototype,"IsHeader",{get:function(){return this.isHeader},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"HeaderSize",{get:function(){return this.headerSize},set:function(e){this.headerSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"IsList",{get:function(){return this.isList},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"IsTable",{get:function(){return this.isTable},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"InTableCell",{get:function(){return this.inTableCell},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"ListItemProps",{get:function(){return this.listItemProps},enumerable:!1,configurable:!0}),C.prototype.SetAsHeader=function(e){this.isHeader=e},C.prototype.SetAsList=function(e){this.isList=e},C.prototype.SetAsTable=function(e){this.isTable=e},C.prototype.SetInsideTableCell=function(e){this.inTableCell=e},C.prototype.SetListStartValue=function(e,t,r){this.listItemProps=new Ee(e,t,r)},C);function C(){this.isHeader=!1,this.isList=!1,this.isTable=!1,this.inTableCell=!1,this.listItemProps=null,this.headerSize=L.Undefined}var B=e("typedjson-npm");D.prototype.SetDimentions=function(e,t){this.width=e,this.height=t},Object.defineProperty(D.prototype,"ImageHeight",{get:function(){return this.height},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"ImageWidth",{get:function(){return this.width},enumerable:!1,configurable:!0}),u([B.JsonMember({name:"imageHeight",type:Number,order:1})],D.prototype,"ImageHeight",null),u([B.JsonMember({name:"imageWidth",type:Number,order:2})],D.prototype,"ImageWidth",null),D=u([B.JsonObject],D);function D(){this.width=0,this.height=0}var V=(Object.defineProperty(J.prototype,"Type",{get:function(){return v.StringFromEnum("ObjectType",this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(J.prototype,"Value",{get:function(){return this.value},enumerable:!1,configurable:!0}),Object.defineProperty(J.prototype,"Metadata",{get:function(){return this.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(J.prototype,"DataRef",{get:function(){return this.dataRef},enumerable:!1,configurable:!0}),Object.defineProperty(J.prototype,"Level",{get:function(){return this.level},set:function(e){this.level=e},enumerable:!1,configurable:!0}),J.prototype.SetValue=function(e,t){this.value=t,this.type=e},J.prototype.Cleanup=function(){this.dataRef||delete this.dataRef},J.prototype.SetBulletMetadata=function(e){e&&(this.metadata||(this.metadata=new Ye),this.metadata.SetBulletMetadata(e))},u([B.JsonMember({name:"type",type:String,order:1})],J.prototype,"Type",null),u([B.JsonMember({name:"value",type:String,order:2})],J.prototype,"Value",null),u([B.JsonMember({name:"meta",type:Object,order:3,emitDefaultValue:!1})],J.prototype,"Metadata",null),u([B.JsonMember({name:"dataRef",type:Object,order:4,emitDefaultValue:!1})],J.prototype,"DataRef",null),u([B.JsonMember({name:"level",type:String,order:5})],J.prototype,"Level",null),J=u([B.JsonObject],J));function J(){this.type=O.Undefined,this.value=""}var R=(Object.defineProperty(G.prototype,"MatrixObjects",{get:function(){return this.matrixObjects},enumerable:!1,configurable:!0}),G.prototype.Cleanup=function(){if(this.matrixObjects&&0<this.matrixObjects.length)for(var e=0;e<this.matrixObjects.length;e++){var t=this.matrixObjects[e];t&&t.Cleanup()}},u([B.JsonMember({name:"matrix",type:Object,order:1})],G.prototype,"MatrixObjects",null),G=u([B.JsonObject],G));function G(){this.matrixObjects=[]}var F=(Object.defineProperty(W.prototype,"Type",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"Value",{get:function(){return this.value},enumerable:!1,configurable:!0}),W.prototype.SetValue=function(e){this.type="string",this.value=e},u([B.JsonMember({name:"type",type:String,order:1})],W.prototype,"Type",null),u([B.JsonMember({name:"value",type:String,order:2})],W.prototype,"Value",null),W=u([B.JsonObject],W));function W(){this.type="",this.value=""}var U=(Object.defineProperty(_.prototype,"OuterMatrix",{get:function(){return this.outerMatrix},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Headers",{get:function(){return this.headers},enumerable:!1,configurable:!0}),_.prototype.Cleanup=function(){if(this.outerMatrix)for(var e=0,t=this.outerMatrix;e<t.length;e++){var r=t[e];r&&r.Cleanup()}},_.prototype.SetHeaders=function(e){if(e&&0<e.length)for(var t=0,r=e;t<r.length;t++){var n=r[t],i=new F;i.SetValue(n.Value),this.headers.push(i)}},u([B.JsonMember({name:"matrix",type:Array,elements:Object,order:1})],_.prototype,"OuterMatrix",null),u([B.JsonMember({name:"header",type:Array,elements:Object,order:2})],_.prototype,"Headers",null),_=u([B.JsonObject],_));function _(){this.outerMatrix=[],this.headers=[]}var K=(Object.defineProperty(z.prototype,"Type",{get:function(){return v.StringFromEnum("MatrixType",this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"MatrixType",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"Data",{get:function(){return this.data},enumerable:!1,configurable:!0}),z.prototype.Cleanup=function(){this.data&&this.data.Cleanup()},u([B.JsonMember({name:"type",type:String,order:1})],z.prototype,"Type",null),u([B.JsonMember({name:"data",type:Object,order:2})],z.prototype,"Data",null),z=u([B.JsonObject],z));function z(e){this.data=new U,this.type=e}var q=(Object.defineProperty(Y.prototype,"Type",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"Value",{get:function(){return this.value},set:function(e){this.value=e},enumerable:!1,configurable:!0}),u([B.JsonMember({name:"type",type:String,order:1})],Y.prototype,"Type",null),u([B.JsonMember({name:"value",type:String,order:1})],Y.prototype,"Value",null),Y=u([B.JsonObject],Y));function Y(){}var X,Q=(X=Z,Object.defineProperty(Z.prototype,"Type",{get:function(){return v.StringFromEnum("PitchDeckSlideType",this.slideType)},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"SlideNumber",{get:function(){return this.slideNumber},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"Title",{get:function(){return this.title},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"SubTitle",{get:function(){return this.subTitle},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"BackgroundImage",{get:function(){return this.backgroundImage},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"Elements",{get:function(){return this.elements},enumerable:!1,configurable:!0}),Z.prototype.SetElements=function(e){e&&0<e.length&&(this.elements||(this.elements=[]),this.elements=this.elements.concat(e))},Z.prototype.SetSlideParameters=function(e,t){this.slideType=e,this.slideNumber=t},Z.prototype.SetTitle=function(e){this.title=new V,this.title.SetValue(O.Text,e)},Z.prototype.SetSubtitle=function(e){this.subTitle=new V,this.subTitle.SetValue(O.Text,e)},Z.prototype.InitializeMatrixListElementsInternal=function(){this.elements||(this.elements=[]);for(var e=null,t=0,r=this.elements;t<r.length;t++){var n=r[t];n&&n.MatrixType==k.List&&(e=n)}if(null==e){e=new K(k.List);var i=[];i.push(e),this.SetElements(i)}return e},Z.prototype.AppendNestedToList=function(e){if(e&&0<e.length){for(var t=this.InitializeMatrixListElementsInternal().Data,r=new R,n=0,i=e;n<i.length;n++){var a=i[n],o=a.Value,s=ke.ObjectTypeFromHtmlTag(a.Tag),l=a.BulletMarker,u=a.Level,p=new V;p.SetValue(s,o),p.Level=u,l&&p.SetBulletMetadata(l),r.MatrixObjects.push(p)}t.OuterMatrix.push(r)}else ie.Instance().Fatal("you are trying to append a zero size nested list")},Z.prototype.AppendToList=function(e){if(e){var t=this.InitializeMatrixListElementsInternal().Data,r=e.Value,n=ke.ObjectTypeFromHtmlTag(e.Tag),i=e.BulletMarker,a=e.Level,o=new V;o.SetValue(n,r),o.Level=a,i&&o.SetBulletMetadata(i);var s=new R;s.MatrixObjects.push(o),t.OuterMatrix.push(s)}else ie.Instance().Fatal("you are trying to append a null member to this list")},Z.prototype.SetList=function(e){if(e&&e.length){var t=new K(k.List),r=[];r.push(t);for(var n=t.Data,i=0;i<e.length;i++){var a=e[i],o=a.Value,s=ke.ObjectTypeFromHtmlTag(a.Tag),l=a.BulletMarker,u=a.Level,p=new V;p.SetValue(s,o),p.Level=u,l&&p.SetBulletMetadata(l);var c=new R;c.MatrixObjects.push(p),n.OuterMatrix.push(c)}this.SetElements(r)}},Z.prototype.SetImages=function(e){if(e&&e.length){var t=new K(k.Image),r=[];this.Elements&&this.Elements.length&&(r=r.concat(this.Elements)),r.push(t);for(var n=t.Data,i=0;i<e.length;i++){var a=e[i],o=new V;o.SetValue(O.Image,a);var s=new R;s.MatrixObjects.push(o),n.OuterMatrix.push(s)}this.SetElements(r)}},Z.prototype.SetLinks=function(e){if(e&&e.length){var t=new K(k.Image),r=[];this.Elements&&this.Elements.length&&(r=r.concat(this.Elements)),r.push(t);for(var n=t.Data,i=0;i<e.length;i++){var a=e[i],o=new V;o.SetValue(O.Url,a);var s=new R;s.MatrixObjects.push(o),n.OuterMatrix.push(s)}this.SetElements(r)}},Z.prototype.SetTable=function(e){if(e&&0<e.length){var t=new K(k.Table),r=[];r.push(t);for(var n=t.Data,i=[],a=[],o=0,s=e;o<s.length;o++){var l=s[o];0<l.filter(function(e){return 0==e.IsPartOfTable}).length?i.push(l):a.push(l)}for(var u=0,p=i;u<p.length;u++){var c=p[u],f=new X;ve.PopulateSlide(1,f,c),f&&(f.Title&&this.SetTitle(f.Title.Value),f.SubTitle&&this.SetSubtitle(f.SubTitle.Value))}if(0<a.length){if(!(0<a[0].filter(function(e){return 0==e.IsBold}).length)){var h=a.shift();n.SetHeaders(h)}for(var d=0,b=a;d<b.length;d++){for(var y=b[d],g=new R,m=0,T=y;m<T.length;m++){var v=T[m],I=new V,S=v.Value;I.SetValue(O.Text,S),g.MatrixObjects.push(I)}n.OuterMatrix.push(g)}}this.SetElements(r)}},Z.prototype.Cleanup=function(){if(this.subTitle?this.subTitle.Cleanup():delete this.subTitle,this.elements&&this.elements.length)for(var e=0;e<this.elements.length;e++){var t=this.elements[e];t&&t.Cleanup()}else delete this.elements;this.title&&this.title.Cleanup()},Object.defineProperty(Z.prototype,"IsValid",{get:function(){var e=!1;return this.Title&&v.IsStringNullOrWhitespace(this.Title.Value)&&(e=!0),this.SubTitle&&v.IsStringNullOrWhitespace(this.SubTitle.Value)&&(e=!0),this.Elements&&0<this.Elements.length&&(e=!0),e},enumerable:!1,configurable:!0}),Z.prototype.DetectAndSetSlideType=function(){var e=T.Undefined;if(this.backgroundImage&&(e=T.TitleAndImages),this.title&&(e=T.TitleOnly),this.subTitle&&(e=T.TitleSubtitle),this.elements&&0<this.elements.length)for(var t=0,r=this.elements;t<r.length;t++){var n=r[t];switch(n.MatrixType){case k.Table:e=e==T.TitleOnly?T.TitleAndTable:e==T.TitleSubtitle?T.TitleSubtitleTable:T.Table;break;case k.List:e=e==T.TitleOnly?T.TitleWithList:e==T.TitleSubtitle?T.TitleSubtitleList:T.List;break;case k.Image:e=e==T.TitleOnly?T.TitleAndImages:e==T.TitleSubtitle?T.TitleSubtitleImage:T.ImageOnly;break;default:ie.Instance().Fatal("DetectAndSetSlideType: Please ask adarsh to support "+k[n.MatrixType])}}this.slideType=e},Z.prototype.SetSlideNumber=function(e){this.slideNumber=e},Z.prototype.SetBackgroundImage=function(e){v.IsStringNullOrWhitespace(e)||(this.backgroundImage=new q,this.backgroundImage.Type="image",this.backgroundImage.Value=e)},u([B.JsonMember({name:"type",type:String,order:1})],Z.prototype,"Type",null),u([B.JsonMember({name:"slideNumber",type:Number,order:2})],Z.prototype,"SlideNumber",null),u([B.JsonMember({name:"title",type:Object,order:3})],Z.prototype,"Title",null),u([B.JsonMember({name:"subtitle",type:Object,order:4})],Z.prototype,"SubTitle",null),u([B.JsonMember({name:"bg",type:Object,order:5})],Z.prototype,"BackgroundImage",null),u([B.JsonMember({name:"elements",type:Array,elements:Object,order:6,emitDefaultValue:!1})],Z.prototype,"Elements",null),Z=X=u([B.JsonObject],Z));function Z(){this.slideType=T.Undefined,this.slideNumber=-10}var ee=(Object.defineProperty(te.prototype,"Value",{get:function(){return this.value},enumerable:!1,configurable:!0}),te.prototype.SetValue=function(e){this.value=e},u([B.JsonMember({name:"value",type:Object,order:1})],te.prototype,"Value",null),te=u([B.JsonObject()],te));function te(){this.value=""}var re=(Object.defineProperty(ce.prototype,"Title",{get:function(){return this.title},enumerable:!1,configurable:!0}),ce.prototype.SetTitle=function(e){this.title=new ee,this.Title.SetValue(e)},u([B.JsonMember({name:"title",type:Object,order:1})],ce.prototype,"Title",null),ce=u([B.JsonObject()],ce));function ce(){this.title=new ee}var fe,he,de=(Object.defineProperty(be.prototype,"Header",{get:function(){return this.matrixHeader},enumerable:!1,configurable:!0}),Object.defineProperty(be.prototype,"Slides",{get:function(){return this.slides},enumerable:!1,configurable:!0}),Object.defineProperty(be.prototype,"Text",{get:function(){return this.text},enumerable:!1,configurable:!0}),Object.defineProperty(be.prototype,"SlideCount",{get:function(){return this.Slides.length},enumerable:!1,configurable:!0}),be.prototype.AddSlide=function(e){var t=e;t.DetectAndSetSlideType(),this.Slides.push(t)},be.prototype.SetTitle=function(e){this.Header.SetTitle(e)},be.prototype.SetText=function(e){v.IsNullOrEmpty(e)||(this.text=e,this.hasText=!0)},be.prototype.Cleanup=function(){if(this.slides&&0<this.slides.length)for(var e=0;e<this.slides.length;e++){var t=this.slides[e];t&&t.Cleanup()}},Object.defineProperty(be.prototype,"HasText",{get:function(){return this.hasText},enumerable:!1,configurable:!0}),u([B.JsonMember({name:"slides",type:Array,elements:Object,order:2})],be.prototype,"Slides",null),u([B.JsonMember({name:"Text",type:Object,order:2})],be.prototype,"Text",null),be=u([B.JsonObject],be));function be(){this.matrixHeader=new re,this.slides=[],this.hasText=!1}(he=fe=fe||{})[he.Number=0]="Number",he[he.CapitalAlphabet=1]="CapitalAlphabet",he[he.LowerAlphabet=2]="LowerAlphabet",he[he.CapitalRoman=3]="CapitalRoman",he[he.LowerRoman=4]="LowerRoman";var ye=(Object.defineProperty(ge.prototype,"IsTable",{get:function(){return this.isTable},set:function(e){this.isTable=e},enumerable:!1,configurable:!0}),Object.defineProperty(ge.prototype,"TitleIndex",{get:function(){return this.titleIndex},set:function(e){this.titleIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(ge.prototype,"SubtitleIndex",{get:function(){return this.subtitleIndex},set:function(e){this.subtitleIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(ge.prototype,"HasTitle",{get:function(){return-1!=this.titleIndex},enumerable:!1,configurable:!0}),Object.defineProperty(ge.prototype,"HasSubtitle",{get:function(){return-1!=this.subtitleIndex},enumerable:!1,configurable:!0}),Object.defineProperty(ge.prototype,"Title",{get:function(){return this.title},set:function(e){this.title=e},enumerable:!1,configurable:!0}),Object.defineProperty(ge.prototype,"Subtitle",{get:function(){return this.subtitle},set:function(e){this.subtitle=e},enumerable:!1,configurable:!0}),ge);function ge(){this.isTable=!1,this.titleIndex=-1,this.subtitleIndex=-1,this.title=null,this.subtitle=null}var me=(Object.defineProperty(Te.prototype,"IsList",{get:function(){return this.isList},set:function(e){this.isList=e},enumerable:!1,configurable:!0}),Object.defineProperty(Te.prototype,"IsOrderedList",{get:function(){return!!this.isList&&this.isOrderedList},set:function(e){(this.isOrderedList=e)&&(this.isList=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Te.prototype,"TitleIndex",{get:function(){return this.titleIndex},set:function(e){this.titleIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(Te.prototype,"SubtitleIndex",{get:function(){return this.subtitleIndex},set:function(e){this.subtitleIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(Te.prototype,"HasTitle",{get:function(){return-1!=this.titleIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Te.prototype,"HasSubtitle",{get:function(){return-1!=this.subtitleIndex},enumerable:!1,configurable:!0}),Te);function Te(){this.isList=!1,this.IsOrderedList=!1,this.titleIndex=-1,this.subtitleIndex=-1}var ve=(Ie.ConvertBucketMapToOutline=function(e,t){t.SetTitle(""),ie.Instance().Debug("Second stage parsing results: \n\n"+ke.DumpBucketGroups(e));for(var r=1,n=null,i=[],a=null,o=0,s=e;o<s.length;o++){var l=s[o];if(l&&0<l.length)if(1==l.length){var u=l[0];if(ke.IsBucketTextType(u)){if((n=n||new Q).Title)if(u.IsPartOfList)n.AppendToList(u);else{var p=!0;if(a&&!a.IsPartOfGroupedObject&&u&&!u.IsPartOfGroupedObject&&(a.HeaderSize==L.Undefined&&u.HeaderSize==L.Undefined&&(p=!1),a.HeaderSize>u.HeaderSize&&(p=!1)),!p){n.SubTitle?n.AppendToList(u):n.SetSubtitle(u.Value),a=null;continue}Ie.ProcessTableIntenal(i,n)&&(i=[]),n.SetSlideNumber(r++),t.AddSlide(n),(n=new Q).SetTitle(u.Value)}else u.IsPartOfGroupedObject?n.AppendToList(u):n.SetTitle(u.Value);a=u}else ke.IsImage(u)?((n=new Q).SetBackgroundImage(u.Value),n.SetSlideNumber(r++),t.AddSlide(n),n=null):ie.Instance().Fatal("ask adarsh to handle non text/image bucket "+JSON.stringify(u))}else{a=null;var c=ke.DetectList(l);if(c&&c.IsList){if(n=n||new Q,!Ie.ProcessTableIntenal(i,n)){n.AppendNestedToList(l);continue}i=[],n.SetSlideNumber(r++),t.AddSlide(n),(n=new Q).SetList(l),n.SetSlideNumber(r++),t.AddSlide(n),a=n=null}else{var f=[];f.push(l);var h=ke.IsTable(f);if(h.IsTable)i.push(l);else{(h.HasTitle||h.HasSubtitle)&&(n=n||new Q,h.HasTitle&&n.SetTitle(h.Title),h.HasSubtitle&&n.SetSubtitle(h.Subtitle));for(var d=[],b=0,y=l;b<y.length;b++)u=y[b],ke.IsImage(u)&&d.push(u.Value);Ie.ProcessImagesIntenal(d,n)&&(n.SetSlideNumber(r++),t.AddSlide(n),n=null)}}}}i&&0<i.length&&(null==n&&(n=new Q),Ie.ProcessTableIntenal(i,n)),null!=n&&(n.SetSlideNumber(r++),t.AddSlide(n))},Ie.ProcessImagesIntenal=function(e,t){return!!(e&&0<e.length)&&(t.SetImages(e),!0)},Ie.ProcessTableBulk=function(e,t){var r=!1,n=T.Table,i=ke.IsTable(e);if(i.IsTable){var a="",o="";v.IsStringNullOrWhitespace(i.Title)||(a=i.Title),v.IsStringNullOrWhitespace(i.Subtitle)||(o=i.Subtitle);for(var s=[],l=e.length,u=0;u<l;u++)u!=i.TitleIndex&&u!=i.SubtitleIndex&&s.push(e[u]);a&&t.SetTitle(a),o&&t.SetSubtitle(o),t.SetSlideParameters(n,1),t.SetTable(s),r=!0}return r},Ie.IdentifySlideType=function(e){var t=T.Undefined,r=e.length;if(e&&0<r)if(1==r)e[0].Tag==p.img?t=T.ImageOnly:ke.IsBucketTextType(e[0])&&(t=T.TitleOnly);else if(2==r)ke.IsBucketTextType(e[0])&&ke.IsBucketTextType(e[1])?t=T.TitleSubtitle:ke.IsBucketTextType(e[0])&&ke.IsListElement(e[1])?t=T.TitleSubtitle:ke.IsBucketTextType(e[0])&&ke.IsImage(e[1])?t=T.TitleAndImages:ke.IsBucketTextType(e[0])&&ke.IsAnchor(e[1])&&(t=T.TitleTextLinks);else{var n=!0,i=!0,a=!0,o=e[0].IsHeader,s=0;s=o?1:0;for(var l=1;l<r;l++)if(!ke.IsListElement(e[l])){n=!1;break}if(n&&(t=o?T.TitleWithList:T.List),t==T.Undefined){for(n=!0,l=s=o?1:0;l<r;l++)if(!ke.IsParagraphElement(e[l])){n=!1;break}n&&(t=o?T.TitleWithList:T.List)}if(t==T.Undefined){for(l=1;l<r;l++)if(!ke.IsImage(e[l])){i=!1;break}i&&(t=T.ImageList)}if(t==T.Undefined){for(a=!0,ke.IsBucketTextType(e[0])&&ke.IsBucketTextType(e[1])?s=2:ke.IsBucketTextType(e[1])&&(s=1),l=s;l<r;l++)if(!ke.IsImage(e[l])){a=!1;break}a&&(t=T.TitleAndImages)}}return t==T.Undefined&&(ie.Instance().Fatal("IdentifySlideType: Cannot Identify bucket of size "+r+" Defaulting to TitleOnly"),t=T.TitleOnly),t},Ie.PopulateSlide=function(e,t,r){var n=Ie.IdentifySlideType(r),i=r.length;switch(t.SetSlideParameters(n,e+1),n){case T.List:for(var a=[],o=0;o<r.length;o++)a.push(r[o]);t.SetList(a);break;case T.TitleOnly:t.SetTitle(r[0].Value);break;case T.ImageOnly:t.SetImages([r[0].Value]);break;case T.TitleSubtitle:t.SetTitle(r[0].Value),t.SetSubtitle(r[1].Value);break;case T.TitleAndImages:var s=0;ke.IsBucketTextType(r[0])&&(t.SetTitle(r[0].Value),s=1),ke.IsBucketTextType(r[1])&&(t.SetSubtitle(r[1].Value),s=2);var l=[];for(o=s;o<i;o++)l.push(r[o].Value);t.SetImages(l);break;case T.TitleTextLinks:t.SetTitle(r[0].Value);var u=[];for(o=1;o<i;o++)u.push(r[o].Value);t.SetLinks(u);break;case T.TitleWithList:for(t.SetTitle(r[0].Value),a=[],o=0;o<r.length;o++)a.push(r[o]);t.SetList(a);break;case T.ImageList:for(l=[],o=0;o<i;o++)l.push(r[o].Value);t.SetImages(l);break;case T.Undefined:ie.Instance().Fatal("Serialize: Cannot process bucket "+e+" => "+B.TypedJSON.stringify(r,{enableTypeHints:!1}));break;default:ie.Instance().Fatal("Unhandled PitchDeckSlideType "+n)}},Ie.ProcessTableIntenal=function(e,t){return!!(e&&0<e.length)&&(t.SetTable(e),!0)},Ie);function Ie(){}var Se=(Oe.CorrectBullets=function(e){var t=!1;if(e)if(t=Oe.CorrectPowerpointGeneratedBullets(e)){ie.Instance().Debug("Powerpoint bullet list detected. Will reorder as a list");for(var r=e.splice(0),n=new Array,i=0;i<r.length;i++){var a=r[i];if(a&&0<a.length)for(var o=0;o<a.length;o++)(p=a[o])&&n.push(p)}e[0]=n}else for(i=0;i<e.length;i++){for(var s=e[i],l=[],u=0;u<s.length;u++){var p=s[u];l.push(p)}if(!(t=Oe.CorrectEmbeddedBullets(l))){for(var c=[],f=0,h=l;f<h.length;f++){var d=h[f];c.push(d)}c.shift(),Oe.CorrectEmbeddedBullets(c)?ie.Instance().Debug("title found in this list."):(c.shift(),Oe.CorrectEmbeddedBullets(c)&&ie.Instance().Debug("title, subtitle found in this list."))}var b=ke.DetectList(l);b.HasTitle&&b.IsList&&(l.splice(b.TitleIndex,1),b.HasSubtitle&&l.splice(b.SubtitleIndex,1))}return t},Oe.CorrectPowerpointGeneratedBullets=function(e){var t=null,r=null;if(e&&0<e.length){if(!Oe.IsPowerpointStyleBullet(e))return!1;for(var n=0;n<e.length;n++)if((o=e[n])&&2==o.length){var i=o[0];if(i&&i.Value){var a=i.Value;if(!r){r=a;continue}if(a!==r){if(!Oe.IsNumberedSequentially(a,r)){t=!1;break}if(null==t){t=!0;break}}else if(null==t){t=!0;break}r=i.Value}}if(t)for(n=0;n<e.length;n++){var o;if((o=e[n])&&1<o.length){var s=o.shift(),l=new P;l.Marker=s.Value,o[0].SetBullet(l)}}}return t},Oe.IsNumberedSequentially=function(e,t){var r=!1;if(t=t||"",e){var n=e,i=t;(e.endsWith(")")||e.endsWith("]")||e.endsWith(">")||e.endsWith(".")||e.endsWith("*")||e.endsWith("+")||e.endsWith("#"))&&(n=e.replace(/[\)|\]|\>|\.|\*|\+|\#|\,]/g,""),i=t.replace(/[\)|\]|\>|\.|\*|\+|\#|\,]/g,"")),Oe.IsNumberInSequence(n,i)?r=!0:Oe.IsRomanNumbersInSequence(n,i)?r=!0:Oe.IsRepeatingCharacters(n,i)&&(r=!0)}return ie.Instance().Debug("Seq: "+r+", current: "+e+", lastString: "+t),r},Oe.IsNumberInSequence=function(e,t){var r=!1;return v.IsNumber(e)&&v.IsNumber(t)&&Number(e)-Number(t)==1&&(r=!0),r},Oe.IsRomanNumbersInSequence=function(e,t){return/^[IVXLCDM]+$/gi.test(e)&&/^[IVXLCDM]+$/gi.test(t)},Oe.IsRepeatingCharacters=function(e,t){return e==t},Oe.CorrectEmbeddedBullets=function(e){var t=!1,r=null;if(e){for(var n=null,i=0;i<e.length;i++)if((l=e[i])&&l.Value){var a=l.Value;if(u=Oe.ExtractEmbeddedBulletMarker(a)){var o=u.Marker,s=u.Text;if(n)if(o!==n){if(!Oe.IsNumberedSequentially(o,n)){r=!1;break}null==r&&(r=!0)}else l.Value==n&&null==r&&(r=!0);n=o}}if(r){for(i=0;i<e.length;i++){var l,u;if((l=e[i])&&l.Value)a=l.Value,(u=Oe.ExtractEmbeddedBulletMarker(a))&&(o=u.Marker,s=u.Text,l.SetTextValue(s),l.SetBullet(u))}t=!0}}return t},Oe.ExtractEmbeddedBulletMarker=function(e){if(!v.IsStringNullOrWhitespace(e)){var t=e.indexOf(" ");if(-1!=t){var r=e.substring(0,t),n=e.substring(t+1),i=new P;return i.Marker=r,i.Text=n,i}}return null},Oe.IsListOrdered=function(e){var t=new me,r=null;if(e&&2<e.length)if(Oe.InternalIsListMarkedAsOrdered(e))r=!0;else{var n=e[0];if(n){var i=n.Value,a=Oe.ExtractEmbeddedBulletMarker(i),o="";a&&(o=a.Marker);for(var s=1;s<e.length;s++){var l=e[s],u="";if(l&&l.Value){var p=l.Value;if(p!==n.Value){var c=Oe.ExtractEmbeddedBulletMarker(p);if(c&&!v.IsStringNullOrWhitespace(c.Marker)&&(u=c.Marker),!Oe.IsNumberedSequentially(u,o)){r=!1;break}null==r&&(r=!0)}else n.Value==o&&null==r&&(r=!0);o=u}}}}return t.IsOrderedList=!!r,t},Oe.IsPowerpointStyleBullet=function(e){for(var t=!0,r=null,n=0;n<e.length;n++){var i=e[n];if(!i||2!=i.length){t=!1;break}if(r){var a=i[0].Value;if(a!=r&&!Oe.IsNumberedSequentially(a,r)){t=!1;break}}else r=i[0].Value}return t},Oe.InternalIsListMarkedAsOrdered=function(e){var t=!0,r=e.length;if(0<r)for(var n=0;n<r;n++){var i=e[n];if(!i.BulletMarker){t=!1;break}if(v.IsStringNullOrWhitespace(i.BulletMarker.Marker)){t=!1;break}}else t=!1;return t},Oe);function Oe(){}var ke=(Le.IsBucketTextType=function(e){var t=!1;if(e)switch(e.Tag){case p.h1:case p.h2:case p.h3:case p.h4:case p.h5:case p.h6:case p.p:t=!0}return t},Le.IsAnchor=function(e){var t=!1;if(e)switch(e.Tag){case p.a:t=!0}return t},Le.IsImage=function(e){var t=!1;if(e)switch(e.Tag){case p.img:case p.figure:t=!0}return t},Le.IsListElement=function(e){var t=!1;if(e)switch(e.Tag){case p.li:t=!0}return t},Le.IsParagraphElement=function(e){var t=!1;if(e)switch(e.Tag){case p.p:t=!0}return t},Le.ConvertBucketArrayToList=function(e){var t=[];if(e)for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i)for(var a=0,o=i;a<o.length;a++){var s=o[a];t.push(s)}}return t},Le.DumpBuckets=function(e){var t="";if(e)for(var r=e.length,n=0;n<r;n++){var i=e[n];t+=i?i.Dump()+"\n":"--"}return v.IsStringNullOrWhitespace(t)&&(t="----"),t+="\n"},Le.DumpBucketGroups=function(e){var t="";if(e&&0<e.length)for(var r=0;r<e.length;r++)t+="Slide "+(r+1)+" => \n    "+Le.DumpBuckets(e[r]);return t},Le.RepositionItems=function(e){for(var t=Le.Clone(e),r=t.length,n=!1,i=!0,a=0;a<r;a++){var o=t[a];o&&(o.Tag==p.img?n=!0:i=!1)}if(i)ie.Instance().Debug("Group has "+r+" images, will not reorder");else if(n)for(var s=t.length-1;0<=s;s--)for(var l=1;l<=s;l++)if(t[l-1].Tag==p.img){var u=t[l-1];t[l-1]=t[l],t[l]=u}return t},Le.Clone=function(e){for(var t=[],r=e.length,n=0;n<r;n++){var i=e[n];t.push(i.Clone())}return t},Le.ObjectTypeFromHtmlTag=function(e){var t=O.Undefined;switch(e){case p.a:t=O.Url;break;case p.img:t=O.Image;break;default:t=O.Text}return t},Le.Flatten=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t},Le.IsTitleSubtitleAndImage=function(e){var t=!1;if(e){var r=e;if(1<r.length){var n=Le.RepositionItems(r);if(Le.IsBucketTextType(n[0])){var i=n.length;if((Le.IsBucketTextType(n[0])?2:1)<i){for(var a=!0,o=0,s=n;o<s.length;o++){var l=s[o];if(!Le.IsImage(l)){a=!1;break}}t=a}}}}return t},Le.ProcessBucketsInGroups=function(e,t){var r=!1;if(Le.IsListOfGroupedItems(t))for(var n=0,i=t;n<i.length;n++){var a=i[n];Le.ReorderImagesInList(a),Le.ProcessTitleSubtitleInternal(e,a)&&(r=!0)}else for(var o=0,s=t;o<s.length;o++){a=s[o];var l=Le.DetectList(a),u=l.HasTitle&&l.IsList;if(l.IsList&&!l.HasTitle||u){var p=a.length,c="",f="";if(u){var h=a[l.TitleIndex];if(h&&!v.IsStringNullOrWhitespace(h.Value)&&(c=h.Value),l.HasSubtitle){var d=a[l.SubtitleIndex];d&&!v.IsStringNullOrWhitespace(d.Value)&&(f=d.Value)}}for(var b=[],y=0;y<p;y++)y!=l.TitleIndex&&y!=l.SubtitleIndex&&b.push(a[y]);Le.ReorderImagesInList(b);var g=u?T.TitleWithList:T.List,m=new Q;m.SetSlideParameters(g,-1),m.SetTitle(c),m.SetSubtitle(f),m.SetList(b),e.AddSlide(m),r=!0}else Le.ProcessTitleSubtitleInternal(e,a)&&(r=!0)}return r},Le.DetectList=function(e){var t=new me;t.IsList=!1;var r=[],n=[];if(e){for(var i=!0,a=0,o=e;a<o.length;a++){var s=o[a];if(s.BulletMarker)n.push(s);else{if(!Le.IsImage(s)&&!Le.IsBucketTextType(s)){ie.Instance().Debug("Detecting List called off. Could not figure bucket "+JSON.stringify(s)),r.length=0,n.length=0,i=!1;break}if(s.IsPartOfTable){i=!1;break}r.push(s)}}if(t.IsList=i){if(0==n.length){if(2<r.length){for(var l=0,u=r;l<u.length;l++){var p=u[l];n.push(p)}r.length=0}}else{for(var c=null,f=null,h=0,d=r;h<d.length;h++)p=d[h],Le.IsBucketTextType(p)&&(v.IsStringNullOrWhitespace(p.Value)||(c?f=f||p:c=p));c&&(t.TitleIndex=e.indexOf(c)),f&&(t.SubtitleIndex=e.indexOf(f))}var b=Se.IsListOrdered(n);b&&(t.IsOrderedList=!!b.IsOrderedList)}}return t},Le.SquashList=function(e){var t=[];if(e&&0<e.length){for(var r=!0,n=0;n<e.length;n++)if(!(a=e[n])||1!=a.length){r=!1;break}if(r){var i=[];for(n=0;n<e.length;n++){var a;(a=e[n])&&1==a.length&&i.push(a[0])}0<i.length&&t.push(i)}}return 0==t.length?e:t},Le.TrimBucketsArray=function(e){var t=[];if(e&&0<e.length){for(var r=0,n=e;r<n.length;r++){var i=n[r];Le.TrimBuckets(i),0<i.length&&t.push(i)}if(0<t.length)for(var a=e.length=0,o=t;a<o.length;a++)i=o[a],e.push(i)}},Le.TrimBucket=function(e){var t=!1;if(e){var r=e.Value,n=v.TrimString(r);e.ChangeValue(n),n!=r&&(t=!0)}return t},Le.TrimBuckets=function(e){var t=[];if(e&&0<e.length){for(var r=0,n=e;r<n.length;r++)(o=n[r])&&(Le.TrimBucket(o),!o.IsPartOfTable&&Le.IsEmpty(o)||t.push(o));for(var i=e.length=0,a=t;i<a.length;i++){var o=a[i];e.push(o)}}},Le.ReorderImagesInList=function(e){var t=!1;if(e&&0<e.length){for(var r=!0,n=!1,i=void 0,a=null,o=0,s=e;o<s.length;o++){var l=s[o];if(a){if(Le.IsBucketTextType(a)){if(!Le.IsImage(l)){r=!1;break}n=!0}else if(!Le.IsBucketTextType(l)){r=!1;break}a=l}else i=Le.IsBucketTextType(a=l)}if(r&&n){var u="Unknown";if(null!=i&&(u=i?"Text":"Image"),ie.Instance().Debug("ReorderImagesInList: sequence found. It starts with "+u),i){for(var p=null,c=[],f=0,h=e;f<h.length;f++)l=h[f],p=Le.IsBucketTextType(l)?l:(c.push(l),p&&c.push(p),null);if(Le.IsEmpty(p)||c.push(p),0<c.length){for(var d=e.length=0,b=c;d<b.length;d++)l=b[d],e.push(l);t=!0}}}}return t},Le.IsEmpty=function(e){var t=!0;return e&&(t=v.IsStringNullOrWhitespace(e.Value)),t},Le.IsTable=function(e){var t=new ye;t.IsTable=!1;var r=[],n=[];if(e&&0<e.length){for(var i=0,a=e;i<a.length;i++){var o=a[i];Le.IsTableRow(o)?n.push(o):r.push(o)}t.IsTable=0<n.length;for(var s=null,l=null,u=0,p=r;u<p.length;u++)for(var c=p[u],f=0,h=c;f<h.length;f++){var d=h[f];if(Le.IsBucketTextType(d)&&!v.IsStringNullOrWhitespace(d.Value))if(s){if(!l){l=c;var b=d;b&&!v.IsStringNullOrWhitespace(b.Value)&&(t.Subtitle=b.Value)}}else{s=c;var y=d;y&&!v.IsStringNullOrWhitespace(y.Value)&&(t.Title=y.Value)}}s&&(t.TitleIndex=e.indexOf(s)),l&&(t.SubtitleIndex=e.indexOf(l))}return t},Le.IsTableRow=function(e){var t=!1;if(e&&0<e.length){for(var r=!0,n=0,i=e;n<i.length;n++)if(!i[n].IsPartOfTable){r=!1;break}t=r}return t},Le.IsListOfGroupedItems=function(e){var t=!1;if(e&&1<e.length){for(var r=!0,n=0,i=e;n<i.length;n++){var a=i[n];if(1<a.length){for(var o=0,s=a;o<s.length;o++)if(!s[o].IsPartOfList){r=!1;break}}else r=!1;if(!r)break}t=r}return t},Le.ProcessTitleSubtitleInternal=function(e,t){var r=!1,n=Le.RepositionItems(t);if(Le.IsBucketTextType(n[0])){var i=n[0],a=null,o=n.length,s=0;s=Le.IsBucketTextType(n[1])?(a=n[1],2):1;var l=new Q,u=ve.IdentifySlideType(n);if(l.SetSlideParameters(u,1),l.SetTitle(i.Value),a&&l.SetSubtitle(a.Value),s<o){for(var p=[],c=s;c<o;c++)p.push(n[c].Value);l.SetImages(p)}r=!0,e.AddSlide(l)}return r},Le.ConvertToHtmlNode=function(e){var t=null;if(e){var r=void 0;e.Tag==p.p?r=ne.Text:e.Tag==p.img&&(r=ne.Image),(t=new ue).SetValue(r,e.Value)}return t},Le);function Le(){}we.TryGroupingUsingHeaders=function(e,t,r){if(r==f.CreateSeparateSlides){var n={};if(we.InternalGroupUsingHeaders(e,n))for(var i in n)t[i]=n[i]}else r==f.ParseAsNestedList||ie.Instance().Fatal("TryGroupingUsingHeaders: cannot use scraping algo "+f[r]);return!1},we.InternalGroupUsingHeaders=function(e,t){var r=!1;if(e&&0<e.length){var n=0,i=[];t[n]=i;for(var a=0;a<e.length;a++){var o=e[a];o.IsHeader&&0<i.length&&(i=[],t[++n]=i),0==i.length&&o.FlagAsHeader(!0),i.push(o)}r=!0}return r},we.IdentifySlideType=function(e){var t=T.Undefined,r=e.length;if(e&&0<r)if(1==r)e[0].IsHeader?t=T.TitleOnly:e[0].Tag==p.img&&(t=T.ImageOnly);else if(2==r)ke.IsBucketTextType(e[0])&&ke.IsBucketTextType(e[1])?t=T.TitleSubtitle:ke.IsBucketTextType(e[0])&&ke.IsListElement(e[1])?t=T.TitleSubtitle:ke.IsBucketTextType(e[0])&&ke.IsImage(e[1])?t=T.TitleAndImages:ke.IsBucketTextType(e[0])&&ke.IsAnchor(e[1])&&(t=T.TitleTextLinks);else{for(var n=!0,i=e[0].IsHeader,a=1;a<r;a++)if(!ke.IsListElement(e[a])){n=!1;break}if(n&&(t=i?T.TitleWithList:T.List),t==T.Undefined){for(n=!0,a=i?1:0;a<r;a++)if(!ke.IsParagraphElement(e[a])){n=!1;break}n&&(t=i?T.TitleWithList:T.List)}}return t==T.Undefined&&(t=T.TitleOnly),t};function we(){}var je=(Pe.prototype.GetAllBuckets=function(){return this.allbuckets},Pe.prototype.GetBuckets=function(e){return this.buckets[e]},Pe.prototype.Add=function(e){this.allbuckets.push(e)},Pe.prototype.DumpAll=function(){return this.DumpBucketList(this.allbuckets)},Pe.prototype.DumpBucketList=function(e){for(var t="",r=0;r<e.length;r++){var n=e[r];t=t.concat(" "+n.Dump()+"\n")}return t},Pe.prototype.DumpGroups=function(){var e="",t=v.GetMemberCount(this.buckets);e=t+" groups found\n\n";for(var r=0;r<t;r++){var n=this.buckets[r];if(!n)break;e=e.concat("   "+r+": "+this.DumpBucketList(n)+"\n")}return e},Pe.prototype.IsEmpty=function(){return!(this.allbuckets&&0<this.allbuckets.length)},Pe);function Pe(){this.buckets={},this.allbuckets=[]}var Ne=(xe.ConvertBucketMapToOutline=function(e,t){ie.Instance().Debug("OutlineListHelper:DumpBucketGroups: "+ke.DumpBucketGroups(e)),t.SetTitle("");var r=new Q,n=T.List;r.SetSlideParameters(n,1);for(var i=[],a=e.length,o=0;o<a;o++){var s=e[o];if(1==a&&1==s.length){var l=s[0].Value;return void t.SetText(l)}if(s&&0<s.length)for(var u=ke.RepositionItems(s),p=0;p<u.length;p++)i.push(u[p])}i&&0<i.length&&r.SetList(i),t.AddSlide(r)},xe);function xe(){}var He=(Object.defineProperty(Ae.prototype,"SlideIndex",{get:function(){return this.slideIndex},enumerable:!1,configurable:!0}),Ae.prototype.IncrementSlideNumber=function(){this.slideIndex++},Object.defineProperty(Ae.prototype,"FirstListLevel",{get:function(){return this.firstListLevel},set:function(e){this.firstListLevel=e},enumerable:!1,configurable:!0}),Ae);function Ae(){this.slideIndex=0,this.firstListLevel=-1,this.slideIndex=0}var Ee=(Object.defineProperty(Me.prototype,"IsListReversed",{get:function(){return this.isListReversed},enumerable:!1,configurable:!0}),Object.defineProperty(Me.prototype,"ListStartNumber",{get:function(){return this.listStartNumber},enumerable:!1,configurable:!0}),Object.defineProperty(Me.prototype,"ListStartMarkerType",{get:function(){return this.listStartMarkerType},enumerable:!1,configurable:!0}),Object.defineProperty(Me.prototype,"LastListStartNumber",{get:function(){return this.lastListStartNumber},set:function(e){this.lastListStartNumber=e},enumerable:!1,configurable:!0}),Me);function Me(e,t,r){this.isListReversed=!1,this.listStartNumber=1,this.lastListStartNumber=1,this.listStartMarkerType=fe.Number,this.isListReversed=r,this.listStartNumber=e,this.lastListStartNumber=e,this.listStartMarkerType=t}var Ce=(Be.DecimalToRoman=function(e){var t="";for(var r in this.romanDecimalMap)for(;e>=this.romanDecimalMap[r];)t+=r,e-=this.romanDecimalMap[r];return t},Be.romanDecimalMap={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},Be);function Be(){}var De=(Ve.GetStartNumber=function(e){var t=oe.GetAttribute(e,"start");return v.IsNumber(t)?Number(t):1},Ve.GetStartType=function(e){var t=fe.Number,r=oe.GetAttribute(e,"type");if(r)switch(r){case"A":t=fe.CapitalAlphabet;break;case"a":t=fe.LowerAlphabet;break;case"I":t=fe.CapitalRoman;break;case"i":case"1":t=fe.LowerRoman}return t},Ve.IsReversed=function(e){return oe.HasAttribute(e,"reversed")},Ve.DetectNumbering=function(e,t){var r=null;if(e){switch(t=e.LastListStartNumber,e.ListStartMarkerType){case fe.CapitalAlphabet:case fe.LowerAlphabet:break;case fe.CapitalRoman:r=(r=Ce.DecimalToRoman(t)).toUpperCase();break;case fe.LowerRoman:r=(r=Ce.DecimalToRoman(t)).toLowerCase();break;case fe.Number:r=t.toString()}e.LastListStartNumber++}return v.IsStringNullOrWhitespace(r)&&(r=t.toString()),r},Ve);function Ve(){}var Je=(Re.prototype.ParseObject=function(e){var t=!1,r=v.Split(e);if(r){t=!0;for(var n=r.length,i=0;i<n;i++)this.lines.push(r[i])}return t},Re.prototype.ConvertToOutline=function(e,t){if(this.scrapeAlgo=t,ie.Instance().Info("TextParser: ConvertToOutline: Scraper Algorithm: "+f[this.scrapeAlgo]),e.SetTitle(""),this.lines&&0<this.lines.length)if(1==this.lines.length&&t==f.ParseAsNestedList){var r=this.lines[0];e.SetText(r)}else{var n=this.GetBuckets(),i=new Q;i.SetSlideParameters(T.List,1),i.SetList(n),e.AddSlide(i)}},Re.prototype.GetBuckets=function(){for(var e=[],t=0;t<this.lines.length;t++)e.push(new x(p.p,this.lines[t]));return e},Re);function Re(){this.lines=[],this.scrapeAlgo=f.Undefined}var Ge=(Fe.prototype.ParseObject=function(e){this.rootNode=new ue,this.rootNode.SetAsRoot();var t=oe.GetEntryPoint(e),r=this.ParseElementRecursively(0,t,null);if(r&&0<r.length)if(1==r.length&&r[0].IsSeparator)this.rootNode=r[0],this.rootNode.SetAsRoot();else{this.rootNode=new ue,this.rootNode.SetAsRoot();for(var n=[],i=0,a=r;i<a.length;i++){var o=a[i];if(o.IsBoundary){if(0<n.length){var s=new ue;s.SetAsSeparator();for(var l=0,u=n;l<u.length;l++){var p=u[l];s.Children.push(p)}this.rootNode.Children.push(s),n.length=0}}else this.rootNode.Children.push(o)}}return ie.Instance().Debug("First stage parsing results"),this.DumpFirstStageResults(this.rootNode,0),!0},Fe.prototype.DetectListInternal=function(e){var t=new pe;t.SetAsList(!0);var r=De.GetStartNumber(e),n=De.GetStartType(e),i=De.IsReversed(e);return t.SetListStartValue(r,n,i),t},Fe.prototype.ParseElementRecursively=function(e,t,r){var n=[];if(t){if(oe.IsPreFormattedElement(t)){var i=t.innerText,a=new Je;a.ParseObject(i);for(var o=0,s=a.GetBuckets();o<s.length;o++){var l=s[o],u=ke.ConvertToHtmlNode(l);u&&(u.SetRenderingBehavior(se.Block),u.SetLevel(e),n.push(u))}return n}var p=null,c=!0;if(oe.HasOnlyTextNodes(t))p=oe.CreateHtmlNodeText(t),c=!1;else if((p=oe.IdentifyHtmlNode(t))&&p.IsLineBreak&&r&&r.IsList)return n;var f=oe.IsElementHeader(t),h=oe.IsElementTable(t),d=oe.IsElementList(t),b=oe.IsElementTableRow(t),y=ae.GetElementRenderingType(t),g=oe.IsElementTableCell(t),m=oe.GetHeaderSize(t),T=null;if(r&&(T=Object.assign(new pe,r)),null==T)f?((T=new pe).SetAsHeader(!0),T.HeaderSize=m):d?T=this.DetectListInternal(t):h&&(T=new pe).SetAsTable(!0);else if(d)T=this.DetectListInternal(t);else if(h&&T&&T.SetAsTable(!0),p){if(p.HeaderSize=T.HeaderSize,T.IsHeader)p.SetAsHeader(!0),T.IsTable&&p.SetAsPartOfTable(!0);else if(T.IsList){var v=new le,I=1;T&&T.ListItemProps&&(I=T.ListItemProps.LastListStartNumber);var S=De.DetectNumbering(T.ListItemProps,I);v.SetNumbering(S),p.SetAsPartOfList(!0,v)}else T.IsTable?p.SetAsPartOfTable(!0):ie.Instance().Warn("localNodeProps found. but the element is not a table, list or header");p.SetBold(T.IsHeader)}if(p&&(p.HasContent||p.IsSeparator)&&(p.SetLevel(e),n.push(p),p.IsSeparator))return n;if(c){var O=oe.GetAllChildren(t);if(O&&0<O.length){for(var k=[],L=0,w=O;L<w.length;L++){var j=w[L];if(!(oe.IsTagIgnorable(j)||b&&oe.IsTextPlaceholder(j))){var P=oe.IsElementTableHeader(j),N=oe.IsElementTableCell(j);T&&(P||N)&&(T.SetInsideTableCell(!0),P?T.SetAsHeader(!0):400<oe.GetFontWeight(j)&&T.SetAsHeader(!0));var x=this.ParseElementRecursively(e+1,j,T);if(x&&0<x.length){var H=!1;if(T&&T.InTableCell){H=!0;for(var A=0,E=x;A<E.length;A++)if(!E[A].IsSeparator){H=!1;break}}H||k.push(x)}}}for(var M=[],C=0,B=k;C<B.length;C++){for(var D=B[C],V=[],J=T&&T.IsTable,R=0,G=D;R<G.length;R++)if((_=G[R])&&(_.HasContent||_.IsSeparator||_.IsBoundary)){if(0<V.length&&(_.IsSeparator||_.IsBoundary)&&!J&&(K=V[V.length-1])&&(K.IsSeparator||K.IsBoundary)&&!K.HasContent){V.pop();var F=new ue;F.SetAsBoundary(),V.push(F);continue}V.push(_)}for(var W=0,U=V;W<U.length;W++){var _,K;if(!(_=U[W]).IsListActual&&_.IsPartOfList&&_.HasChildren&&M&&0<M.length&&(K=M[M.length-1])&&K.IsPartOfList)K.Children.push(_);else if(ue.HasValue(_))switch(_.RenderingBehaviorType){case se.Block:M.push(_);break;case se.Inline:var z=!1;if(M&&0<M.length&&ue.AreBothInlineTextNodes(M[M.length-1],_)){var q=ue.JoinInlineNodes(M[M.length-1],_);q&&(M.pop(),M.push(q),z=!0)}z||M.push(_);break;case se.DontDisplay:ie.Instance().Info("will not display this component");break;case se.Unspecified:default:ie.Instance().Fatal("Level-"+e+" render type should not be Unspecified");continue}else M.push(_)}}if(b){(Q=new ue).SetAsPartOfTable(!0),Q.SetAsSeparator();for(var Y=0,$=M;Y<$.length;Y++){var X=$[Y];Q.Children.push(X)}n.push(Q)}else if(0<M.length)if(1==M.length)(j=M.pop()).SetRenderingBehavior(y),j.SetLevel(e),d?((Q=new ue).SetAsSeparator(),Q.SetAsListActual(),r&&r.IsList&&(Q.IsListNestedWithinList=!0),Q.SetAsPartOfList(!0),Q.Children.push(j),n.push(Q)):n.push(j);else{var Q;(Q=new ue).SetAsSeparator(),d&&(Q.SetAsListActual(),Q.SetAsPartOfList(!0),r&&r.IsList&&(Q.IsListNestedWithinList=!0));for(var Z=0,ee=M;Z<ee.length;Z++)j=ee[Z],Q.Children.push(j);n.push(Q)}}}if(T&&g&&0==n.length){var te=!1;if(p&&p.IsValid()||(te=!0),te){var re=new ue;re.SetValue(ne.Text,""),re.SetRenderingBehavior(se.Block),re.SetAsPartOfTable(!0),re.SetAsTableCellBlank(!0),n.push(re)}}}else ie.Instance().Fatal("ParseRecursively: rootElement is null.");return n},Fe.prototype.HasDirectChildValues=function(e,t){var r=!1;if(e){var n=oe.GetSupportedChildren(e);r=n&&0<n.length}return r},Fe.prototype.LogText=function(e,t){for(var r="",n=0;n<e;n++)r+="\t";r+=t,ie.Instance().Debug(""+r)},Fe.prototype.DumpFirstStageResults=function(e,t){var r=this;if(e){var n=e.Children;this.DumpValue(e,t),n.forEach(function(e){e?r.DumpFirstStageResults(e,t+1):ie.Instance().Debug("Level: "+t+": NULL")})}else ie.Instance().Debug("rootNode is Null! at Level "+t)},Fe.prototype.DumpValue=function(e,t){var r=e.Value,n=e.NodeType,i=e.Children.length;if(n==ne.Root)this.LogText(t,"Root [Display: "+e.RenderingBehavior+", Level: "+t+", Child Count: "+i+"]");else if(n==ne.Separator)this.LogText(t,"Separator [Level: "+t+", Child Count: "+i+", IsList: "+e.IsPartOfList+"]");else if(n==ne.Boundary)this.LogText(t,"Boundary [Level: "+t+", Child Count: "+i+"]");else{var a=ne[e.NodeType];this.LogText(t,a+" [Level: "+t+", Display: "+e.RenderingBehavior+", "+(e.IsHeader?" Header: Yes,":"")+(e.IsPartOfList?" List: Yes,":"")+(e.IsPartOfTable?" Table: Yes,":"")+" NodeType: "+ne[n]+", Children: "+i+'] | "'+r+'"')}},Fe.prototype.ConvertToOutline=function(e,t){var r=this.rootNode;if(this.scrapeAlgo=t,ie.Instance().Info("ConvertToOutline: Scraper Algorithm: "+f[this.scrapeAlgo]),r){for(var n=new He,i=new Array,a=0,o=r.Children;a<o.length;a++){var s=o[a],l=this.ConvertToBucketsInternal(0,n,s);if(l&&0<l.length)for(var u=0,p=l;u<p.length;u++){var c=p[u];c&&0<c.length&&i.push(c)}}ke.TrimBucketsArray(i),Se.CorrectBullets(i),t==f.CreateSeparateSlides?ve.ConvertBucketMapToOutline(i,e):t==f.ParseAsNestedList&&Ne.ConvertBucketMapToOutline(i,e)}},Fe.prototype.ConvertToBucketsInternal=function(e,t,r){var n=[];r.IsListActual&&-1==t.FirstListLevel&&(t.FirstListLevel=e);var i=x.FromHtmlNode(r);if(i){var a=[];a.push(i),n.push(a)}if(r.Children&&0<r.Children.length){for(var o=[],s=0,l=r.Children;s<l.length;s++){var u=l[s],p=this.ConvertToBucketsInternal(e+1,t,u);if(0<p.length)if(u.IsSeparator)if(u.IsListNestedWithinList)if(n&&0<n.length){var c;c=t.FirstListLevel==e?n[n.length-1]:n[0];for(var f=0,h=p;f<h.length;f++)if((I=h[f])&&0<I.length)for(var d=0,b=I;d<b.length;d++){var y=b[d];c.push(y)}}else ie.Instance().Debug("ConvertToBucketsInternal: yielded no results or the currentBucketList is null.");else for(var g=0,m=p;g<m.length;g++)(I=m[g])&&0<I.length&&n.push(I);else for(var T=0,v=p;T<v.length;T++){var I;if(I=v[T])if(u.IsPartOfList)n.push(I);else for(var S=0,O=I;S<O.length;S++){var k=O[S];k&&o.push(k)}}}0<o.length&&n.push(o)}return n},Fe);function Fe(){this.rootNode=void 0,this.scrapeAlgo=f.Undefined}var We=(Ue.SetCookie=function(e,t){var r=new Date,n=t;r.setTime(r.getTime()+6048e5),document.cookie=e+"="+n+"; expires="+r.toUTCString()+"; path=/"},Ue.GetCookie=function(e){var t=("; "+document.cookie).split("; "+e+"=");return 2==t.length?t.pop().split(";").shift():null},Ue.DeleteCookie=function(e){var t=new Date;t.setTime(t.getTime()+-864e5),document.cookie=e+"=; expires="+t.toUTCString()+"; path=/"},Ue);function Ue(){}!function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Clippy=void 0;var r=(n.Scrape=function(e,t,r){if(ie.Instance().Debug("started parsing HTML element "+e+", algo: "+f[t]),ie.Instance().Debug("Html: "+e.outerHTML),e&&r){var n=new Ge;if(n.ParseObject(e)){var i=new de;n.ConvertToOutline(i,t),i.Cleanup();var a=B.TypedJSON.stringify(i,{enableTypeHints:!1}),o=JSON.parse(a),s={ok:!0,error:!1,message:"process completed",outline:v.CleanupJSONObject(o),text:null};i.HasText&&(delete s.outline,s.text=i.Text),r(v.CleanupJSONObject(s))}else r(s={ok:!1,error:!0,message:"parsing failed",outline:null,text:null})}},n.Dump=function(e,t){var r=JSON.stringify(e,t,2).toString();n.Info(r)},n.prototype.ElementCallback=function(e,t){var r=t.level;ie.Instance().Info(">"+r+" "+$(e).html()),this.bucket.Add(e)},n.ScrapeText=function(e,t,r){if(ie.Instance().Info("ScrapeText started parsing TEXT element, algo: "+f[t]),e){var n=new Je,i=new de;n.ParseObject(e)&&n.ConvertToOutline(i,t),i.Cleanup();var a=B.TypedJSON.stringify(i,{enableTypeHints:!1}),o=JSON.parse(a),s={ok:!0,error:!1,message:"process completed",outline:v.CleanupJSONObject(o),text:null};i.HasText&&(delete s.outline,s.text=i.Text),r(v.CleanupJSONObject(s))}else r({ok:!0,error:!0,message:"ScrapeText: failed"})},n.SetCookie=function(e,t){We.SetCookie(e,t)},n.Info=function(e){ie.Instance().Info(e)},n.Debug=function(e){ie.Instance().Debug(e)},n);function n(){this.bucket=new je}t.Clippy=r}(0,r);var _e=e("./version.json"),Ke=(ze.DumpVersionInfo=function(){ie.Instance().Info("Pitchdeck clipboard handler ("+_e.version+"), "+_e.comments)},ze);function ze(){}(function(){Ke.DumpVersionInfo()}).call(this);qe.SPACE=" ";function qe(){}var Ye=(Object.defineProperty($e.prototype,"Bullet",{get:function(){return this.bullet},enumerable:!1,configurable:!0}),$e.prototype.SetBulletMetadata=function(e){e&&(this.bullet=new Xe(e))},u([B.JsonMember({name:"bullet",type:Object,order:1,emitDefaultValue:!1})],$e.prototype,"Bullet",null),$e=u([B.JsonObject],$e));function $e(){}var Xe=(Object.defineProperty(Qe.prototype,"BulletMarker",{get:function(){return this.bulletMarker},enumerable:!1,configurable:!0}),u([B.JsonMember({name:"marker",type:String,order:1})],Qe.prototype,"BulletMarker",null),Qe=u([B.JsonObject],Qe));function Qe(e){this.bulletMarker=null,e&&(this.bulletMarker=e.Marker)}Ze.prototype.DetectBoundaries=function(e){var t=oe.GetEntryPoint(e);if(t){var r=$(t).children();if(r&&0<r.length)for(var n=r.length,i=0;i<n;i++){var a=r[i];oe.IsTagIgnorable(a)}}return[]};function Ze(){}},{"./version.json":2,"typedjson-npm":3}],2:[function(e,t,r){t.exports={version:"0.6.5",comments:"Built by the ClipboardJS project owner, Presentations.AI Team on December 27th 2022, 6:07:54 PM"}},{}],3:[function(require,module,exports){!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports"],e)}(function(require,exports){"use strict";var METADATA_FIELD_KEY="__typedJsonJsonObjectMetadataInformation__",JSON,Ut,Vt,Wt,Yt,Helpers,fu;function Xt(e){return Wt[e]||"\\u"+(e.charCodeAt(0)+65536).toString(16).substr(1)}function iu(e){var t;return"function"==typeof e?t=e:"object"==typeof e&&(t=e.constructor),t?"name"in t&&"string"==typeof t.name?t.name:t.toString().match(/function (\w*)/)[1]:"undefined"}JSON=JSON||{parse:function(sJSON){var returnval=sJSON;return"object"==typeof returnval?returnval:eval("("+sJSON+")")},stringify:(Ut=Object.prototype.toString,Vt=Array.isArray||function(e){return"[object Array]"===Ut.call(e)},Wt={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},Yt=/[\\"\u0000-\u001F\u2028\u2029]/g,function e(t){if(null==t)return"null";if("number"==typeof t)return isFinite(t)?t.toString():"null";if("boolean"==typeof t)return t.toString();if("object"==typeof t){if("function"==typeof t.toJSON)return e(t.toJSON());if(Vt(t)){for(var r="[",n=0;n<t.length;n++)r+=(n?", ":"")+e(t[n]);return r+"]"}if("[object Object]"===Ut.call(t)){var i=[];for(var a in t)t.hasOwnProperty(a)&&i.push(e(a)+": "+e(t[a]));return"{"+i.join(", ")+"}"}}return'"'+t.toString().replace(Yt,Xt)+'"'})},fu=Helpers=Helpers||{},fu.assign=function(e){for(var t,r,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(null==e)throw new TypeError("Cannot convert undefined or null to object");t=Object(e);for(var a=1;a<arguments.length;a++)if(null!=(r=arguments[a]))for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);return t},fu.error=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];"object"==typeof console&&"function"==typeof console.error?console.error.apply(console,[e].concat(t)):"object"==typeof console&&"function"==typeof console.log&&console.log.apply(console,["ERROR: "+e].concat(t))},fu.getClassName=iu,fu.getDefaultValue=function(e){switch(e){case Number:return 0;case String:return"";case Boolean:return!1;case Array:return[];default:return null}},fu.getPropertyDisplayName=function(e,t){return iu(e)+"."+t.toString()},fu.isArray=function(e){return"function"==typeof Array.isArray?Array.isArray(e):e instanceof Array},fu.isPrimitive=function(e){switch(typeof e){case"string":case"number":case"boolean":return!0}return e instanceof String||e===String||e instanceof Number||e===Number||e instanceof Boolean||e===Boolean},fu.isReservedMemberName=function(e){return e===METADATA_FIELD_KEY},fu.isSubtypeOf=function(e,t){var r=e.prototype;if(e===t)return!0;for(;r;){if(r instanceof t)return!0;r=r.prototype}return!1},fu.log=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];"object"==typeof console&&"function"==typeof console.log&&console.log.apply(console,[e].concat(t))},fu.merge=function(t){for(var r,e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(null==t)throw new TypeError("Cannot convert undefined or null to object");r={},Object.keys(t).forEach(function(e){r[e]=t[e]});for(var a=1;a<arguments.length;a++)if(null!=(e=arguments[a]))for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);return r},fu.valueIsDefined=function(e){return null!=e},fu.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];"object"==typeof console&&"function"==typeof console.warn?console.warn.apply(console,[e].concat(t)):"object"==typeof console&&"function"==typeof console.log&&console.log.apply(console,["WARNING: "+e].concat(t))};var JsonMemberMetadata=function(){},JsonObjectMetadata=(cv.getJsonObjectName=function(e,t){void 0===t&&(t=!0);var r=this.getFromType(e,t);return null!==r?r.className:Helpers.getClassName(e)},cv.getFromType=function(e,t){var r,n;return void 0===t&&(t=!0),(r="function"==typeof e?e.prototype:e)?(r.hasOwnProperty(METADATA_FIELD_KEY)?n=r[METADATA_FIELD_KEY]:t&&r[METADATA_FIELD_KEY]&&(n=r[METADATA_FIELD_KEY]),n&&n.isExplicitlyMarked?n:null):null},cv.getFromInstance=function(e,t){return void 0===t&&(t=!0),this.getFromType(Object.getPrototypeOf(e),t)},cv.getKnownTypeNameFromType=function(e){var t=this.getFromType(e,!1);return t?t.className:Helpers.getClassName(e)},cv.getKnownTypeNameFromInstance=function(e){var t=this.getFromInstance(e,!1);return t?t.className:Helpers.getClassName(e.constructor)},Object.defineProperty(cv.prototype,"dataMembers",{get:function(){return this._dataMembers},enumerable:!0,configurable:!0}),Object.defineProperty(cv.prototype,"className",{get:function(){return"string"==typeof this._className?this._className:Helpers.getClassName(this.classType)},set:function(e){this._className=e},enumerable:!0,configurable:!0}),Object.defineProperty(cv.prototype,"knownTypes",{get:function(){var t,r;return t={},this._knownTypes.forEach(function(e){r=cv.getKnownTypeNameFromType(e),t[r]=e}),this._knownTypeCache=t},enumerable:!0,configurable:!0}),cv.prototype.setKnownType=function(e){-1===this._knownTypes.indexOf(e)&&(this._knownTypes.push(e),this._knownTypeCache=null)},cv.prototype.addMember=function(t){var r=this;Object.keys(this._dataMembers).forEach(function(e){if(r._dataMembers[e].name===t.name)throw new Error("A member with the name '"+t.name+"' already exists.")}),this._dataMembers[t.key]=t},cv.prototype.sortMembers=function(){var t=this,r=[];Object.keys(this._dataMembers).forEach(function(e){r.push(t._dataMembers[e])}),r=r.sort(this.sortMembersCompare),this._dataMembers={},r.forEach(function(e){t._dataMembers[e.key]=e})},cv.prototype.sortMembersCompare=function(e,t){if("number"!=typeof e.order&&"number"!=typeof t.order){if(e.name<t.name)return-1;if(e.name>t.name)return 1}else{if("number"!=typeof e.order)return 1;if("number"!=typeof t.order)return-1;if(e.order<t.order)return-1;if(e.order>t.order)return 1;if(e.name<t.name)return-1;if(e.name>t.name)return 1}return 0},cv);function cv(){this._dataMembers={},this._knownTypes=[],this._knownTypeCache=null,this.isExplicitlyMarked=!1}function JsonObject(e){function t(t){var r,n,i;if(t.prototype.hasOwnProperty(METADATA_FIELD_KEY)?r=t.prototype[METADATA_FIELD_KEY]:(r=new JsonObjectMetadata,(n=t.prototype[METADATA_FIELD_KEY])&&(Object.keys(n.dataMembers).forEach(function(e){r.dataMembers[e]=n.dataMembers[e]}),Object.keys(n.knownTypes).forEach(function(e){r.setKnownType(n.knownTypes[e])})),Object.defineProperty(t.prototype,METADATA_FIELD_KEY,{enumerable:!1,configurable:!1,writable:!1,value:r})),r.classType=t,r.isExplicitlyMarked=!0,a.name&&(r.className=a.name),a.knownTypes){i=0;try{a.knownTypes.forEach(function(e){if(void 0===e)throw new TypeError("Known type #"+i+++" is undefined.");r.setKnownType(e)})}catch(e){Helpers.error(new TypeError("@JsonObject: "+e.message+" (on '"+Helpers.getClassName(t)+"')"))}}"function"==typeof o&&(r.initializer=o),"function"==typeof s&&(r.serializer=s)}var a,o=(a="function"==typeof e?{}:e||{}).initializer,s=a.serializer;return"function"==typeof e?t(e):t}function jsonMemberTypeInit(e,t,r){if(void 0===r&&(r=!1),e.elements&&("function"==typeof e.elements&&(e.elements={type:e.elements}),e.type||(e.type=Array)),e.type===Array)if(e.elements)jsonMemberTypeInit(e.elements,t+"[]",!0);else{if(!r)throw new Error("No valid 'elements' option was specified for '"+t+"'.");Helpers.warn("No valid 'elements' option was specified for '"+t+"'.")}if("function"!=typeof e.type)throw new Error("No valid 'type' option was specified for '"+t+"'.")}function jsonMemberKnownTypes(e){var t=new Array;return t.push(e.type),e.elements&&(t=t.concat(jsonMemberKnownTypes(e.elements))),t}function JsonMember(e,t){var o,r,s=new JsonMemberMetadata;return o="string"==typeof t||"symbol"==typeof t?{}:e||{},r=function(e,t){Object.getOwnPropertyDescriptor(e,t.toString());var r,n,i,a=Helpers.getPropertyDisplayName(e,t);if("function"==typeof e)throw new TypeError("@JsonMember cannot be used on a static property ('"+a+"').");if("function"==typeof e[t])throw new TypeError("@JsonMember cannot be used on a method property ('"+a+"').");if(o.hasOwnProperty("elementType")&&(Helpers.warn(a+": the 'elementType' option is deprecated, use 'elements' instead."),o.elements=o.elementType,o.elementType===Array&&(s.forceEnableTypeHinting=!0)),(s=Helpers.assign(s,o)).key=t.toString(),s.name=o.name||t.toString(),Helpers.isReservedMemberName(s.name))throw new Error("@JsonMember: '"+s.name+"' is a reserved name.");if(o.hasOwnProperty("type")&&void 0===o.type)throw new TypeError("@JsonMember: 'type' of '"+a+"' is undefined.");if("object"==typeof Reflect&&"function"==typeof Reflect.getMetadata){if(void 0===(i=Reflect.getMetadata("design:type",e,t)))throw new TypeError("@JsonMember: type detected for '"+a+"' is undefined.");s.type&&"function"==typeof s.type?s.type!==i&&Helpers.warn("@JsonMember: 'type' specified for '"+a+"' does not match detected type."):s.type=i}jsonMemberTypeInit(s,a),e.hasOwnProperty(METADATA_FIELD_KEY)?r=e[METADATA_FIELD_KEY]:(r=new JsonObjectMetadata,(n=e[METADATA_FIELD_KEY])&&Object.keys(n.dataMembers).forEach(function(e){r.dataMembers[e]=n.dataMembers[e]}),Object.defineProperty(e,METADATA_FIELD_KEY,{enumerable:!1,configurable:!1,writable:!1,value:r})),jsonMemberKnownTypes(s).forEach(function(e){r.setKnownType(e)});try{r.addMember(s)}catch(e){throw new Error("Member '"+s.name+"' already exists on '"+Helpers.getClassName(r.classType)+"'.")}},"string"==typeof t||"symbol"==typeof t?r(e,t):r}exports.JsonObject=JsonObject,exports.JsonMember=JsonMember;var Serializer=(jw.writeObject=function(e,t){var r,n=JsonObjectMetadata.getFromInstance(e);return r=n?n.classType:e.constructor,JSON.stringify(this.writeToJsonObject(e,{objectType:r,enableTypeHints:t.enableTypeHints,typeHintPropertyKey:t.typeHintPropertyKey}),t.replacer)},jw.writeToJsonObject=function(r,n){var i,a,o=this;if(null==r)i=n.emitDefault?Helpers.getDefaultValue(n.objectType):r;else if(Helpers.isPrimitive(r)||r instanceof Date)i=r;else if(r instanceof Array){i=[];for(var e=0,t=r.length;e<t;e++)i.push(this.writeToJsonObject(r[e],{elements:n.elements?n.elements.elements:null,enableTypeHints:n.enableTypeHints,objectType:n.elements?n.elements.type:Object,requireTypeHints:n.requireTypeHints,typeHintPropertyKey:n.typeHintPropertyKey}))}else(a=JsonObjectMetadata.getFromInstance(r))&&"function"==typeof a.serializer?i=a.serializer(r):(i={},n.enableTypeHints&&(n.requireTypeHints||r.constructor!==n.objectType)&&(i[n.typeHintPropertyKey]=JsonObjectMetadata.getKnownTypeNameFromInstance(r)),a?(a.sortMembers(),Object.keys(a.dataMembers).forEach(function(e){var t=a.dataMembers[e];i[t.name]=o.writeToJsonObject(r[e],{elements:t.elements,emitDefault:t.emitDefaultValue,enableTypeHints:n.enableTypeHints,name:t.name,objectType:t.type,requireTypeHints:n.requireTypeHints,typeHintPropertyKey:n.typeHintPropertyKey})})):Object.keys(r).forEach(function(e){i[e]=o.writeToJsonObject(r[e],{enableTypeHints:n.enableTypeHints,objectType:Object,requireTypeHints:n.requireTypeHints,typeHintPropertyKey:n.typeHintPropertyKey})}));return i},jw);function jw(){}var Deserializer=(yw.readObject=function(e,t,r){var n,i=JsonObjectMetadata.getFromType(t);if(n="Object"==typeof e?e:JSON.parse(e,r.reviver),"number"==typeof r.maxObjects&&this.countObjects(n)>r.maxObjects)throw new Error("JSON exceeds object count limit ("+r.maxObjects+").");return this.readJsonToInstance(n,{objectType:t,typeHintPropertyKey:r.typeHintPropertyKey,enableTypeHints:r.enableTypeHints,strictTypeHintMode:!0,knownTypes:i?i.knownTypes:{}})},yw.countObjects=function(t){var r=this;switch(typeof t){case"object":if(null===t)return 0;if(Helpers.isArray(t)){var n=0;return t.forEach(function(e){n+=r.countObjects(e)}),n}var i=0;return Object.keys(t).forEach(function(e){i+=r.countObjects(t[e])}),i;case"undefined":return 0;default:return 1}},yw.readJsonToInstance=function(r,n){var i,a,e,t,o,s=this;if(null==r){if(n.isRequired)throw new Error("Missing required member.")}else if(Helpers.isPrimitive(n.objectType)){if(r.constructor!==n.objectType){var l=Helpers.getClassName(n.objectType).toLowerCase(),u=Helpers.getClassName(r.constructor).toLowerCase();throw new TypeError("Expected value to be of type '"+l+"', got '"+u+"'.")}i=r}else if(n.objectType===Array){if(!Helpers.isArray(r))throw new TypeError("Expected value to be of type 'Array', got '"+Helpers.getClassName(r.constructor)+"'.");i=[],r.forEach(function(e){i.push(s.readJsonToInstance(e,{elements:n.elements?n.elements.elements:null,enableTypeHints:n.enableTypeHints,knownTypes:n.knownTypes,objectType:n.elements?n.elements.type:e.constructor,requireTypeHints:n.requireTypeHints,strictTypeHintMode:n.strictTypeHintMode,typeHintPropertyKey:n.typeHintPropertyKey}))})}else if(n.objectType===Date)if("string"==typeof r)i=new Date(r);else{if(!(r instanceof Date))throw new TypeError("Expected value to be of type 'string', got '"+typeof r+"'.");i=r}else{if((t=r[n.typeHintPropertyKey])&&n.enableTypeHints){if("string"!=typeof t)throw new TypeError("Type-hint ("+n.typeHintPropertyKey+") must be a string.");if(!n.knownTypes[t])throw new Error("'"+t+"' is not a known type.");if(n.strictTypeHintMode&&!Helpers.isSubtypeOf(n.knownTypes[t],n.objectType))throw new Error("'"+t+"' is not a subtype of '"+Helpers.getClassName(n.objectType)+"'.");e=n.knownTypes[t],a=JsonObjectMetadata.getFromType(e)}else{if(n.enableTypeHints&&n.requireTypeHints)throw new Error("Missing required type-hint.");e=n.objectType,a=JsonObjectMetadata.getFromType(n.objectType)}a?"function"==typeof a.initializer?i=a.initializer(r)||null:(a.sortMembers(),i=new e,Object.keys(a.dataMembers).forEach(function(e){var t=a.dataMembers[e];o=s.readJsonToInstance(r[t.name],{elements:t.elements,enableTypeHints:n.enableTypeHints,isRequired:t.isRequired,knownTypes:Helpers.merge(n.knownTypes,a.knownTypes||{}),objectType:t.type,requireTypeHints:n.requireTypeHints,strictTypeHintMode:n.strictTypeHintMode,typeHintPropertyKey:n.typeHintPropertyKey}),Helpers.valueIsDefined(o)&&(i[e]=o)})):(i={},Object.keys(r).forEach(function(e){r[e]&&e!==n.typeHintPropertyKey&&(i[e]=s.readJsonToInstance(r[e],{enableTypeHints:n.enableTypeHints,knownTypes:n.knownTypes,objectType:r[e].constructor,requireTypeHints:n.requireTypeHints,typeHintPropertyKey:n.typeHintPropertyKey}))}))}return i},yw);function yw(){}var configSettings={enableTypeHints:!0,typeHintPropertyKey:"__type"},TypedJSON={config:function(e){configSettings=Helpers.merge(configSettings,e)},stringify:function(e,t){return Serializer.writeObject(e,Helpers.merge(configSettings,t||{}))},parse:function(e,t,r){return JsonObjectMetadata.getFromType(t)?Deserializer.readObject(e,t,Helpers.merge(configSettings,r||{})):JSON.parse.apply(JSON,arguments)}};exports.TypedJSON=TypedJSON})},{}]},{},[1])(1)});